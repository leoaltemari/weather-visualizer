@if (error$ | async; as error) {
  <app-error-card
    [errorMessage]="error"
    [tryAgainFunction]="retryFetch.bind(this)"
  ></app-error-card>
} @else if (weatherData$ | async; as weatherData) {
  <app-map-controls class="rounded-2xl md:col-span-2"></app-map-controls>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-[24px]">
    <app-station-data></app-station-data>
    <app-map></app-map>
    <app-forecast class="md:col-span-2 lg:col-span-1"></app-forecast>
    <app-forecast-chart class="md:col-span-2 lg:col-span-1"></app-forecast-chart>
  </div>

  <!-- Loading State -->
} @else {
  <div class="flex flex-col items-center justify-center gap-8">
    <app-loading-spinner></app-loading-spinner>

    <div class="loading-text">
      <h2>Loading Weather Data</h2>
      <p>Fetching the latest weather information</p>
    </div>
  </div>

  <div class="skeleton-grid">
    <div class="skeleton-card wide">
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar medium"></div>
    </div>
    <div class="skeleton-card tall">
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar medium"></div>
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar medium"></div>
      <div class="skeleton-bar"></div>
    </div>
    <div class="skeleton-card tall">
      <div class="skeleton-bar short"></div>
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar medium"></div>
      <div class="skeleton-bar short"></div>
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar medium"></div>
    </div>
    <div class="skeleton-card wide">
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar"></div>
      <div class="skeleton-bar short"></div>
    </div>
  </div>
}
